{"is_source_file": true, "format": "Kotlin", "description": "This file defines a singleton object CartRepository in Kotlin, which manages an in-memory shopping cart with local persistence in an Android application. It handles cart state initialization, item additions, removals, quantity updates, and computes totals including subtotal, delivery fee, taxes, and overall total. It also leverages LiveData to expose cart data changes to UI components.", "external_files": ["org.example.app.data.models.CartLine", "org.example.app.data.models.MenuItem", "org.example.app.data.storage.PreferencesStorage", "org.example.app.data.storage.models.StoredCartLine"], "external_methods": ["PreferencesStorage.from()", "loadCartLines()", "saveCartLines()"], "published": ["CartRepository"], "classes": [], "methods": [{"name": "initialize", "description": "Initializes the cart repository from persisted data stored in shared preferences, constructing cart lines from stored cart lines."}, {"name": "add", "description": "Adds one quantity of the specified menu item to the cart."}, {"name": "remove", "description": "Removes the specified menu item from the cart entirely."}, {"name": "updateQuantity", "description": "Sets the quantity for a given menu item; removes the item if quantity is zero or less."}, {"name": "getQuantity", "description": "Returns the current quantity of a cart item by its ID."}, {"name": "computeSubtotalCents", "description": "Calculates the subtotal cost of all items in the cart."}, {"name": "computeDeliveryFeeCents", "description": "Returns a flat delivery fee if the cart is not empty, otherwise zero."}, {"name": "computeTaxCents", "description": "Calculates the tax amount based on the subtotal and tax rate."}, {"name": "computeTotalCents", "description": "Calculates total cost including subtotal, delivery fee, and taxes."}, {"name": "publish", "description": "Updates LiveData objects with current cart state and optionally persists the cart."}, {"name": "persistCart", "description": "Persists current cart lines to shared preferences."}], "calls": ["PreferencesStorage.from()", "loadCartLines()", "saveCartLines()"], "search-terms": ["CartRepository", "add(item: MenuItem)", "calculateTotal", "PersistentStorage", "LiveData cart", "initialize"], "state": 2, "file_id": 14, "knowledge_revision": 78, "git_revision": "bee0400471853af593870aafc261dd9c589a0db7", "revision_history": [{"49": ""}, {"78": "bee0400471853af593870aafc261dd9c589a0db7"}], "hash": "4d9e83ba3ff7204e7dcc5d3f2b970f1d", "format-version": 4, "code-base-name": "android_frontend", "filename": "android_frontend/app/src/main/kotlin/org/example/app/data/cart/CartRepository.kt"}